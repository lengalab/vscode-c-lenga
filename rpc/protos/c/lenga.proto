syntax = "proto3";

package c.lenga;

import public "c/objects.proto";

service CLenga {
    rpc Initialize(InitRequest) returns (SessionId);
    rpc OpenFile(OpenRequest) returns (SourceFile);
    rpc Edit(EditRequest) returns (EditResponse);
    rpc Save(SaveRequest) returns (Void);
    rpc CloseFile(CloseRequest) returns (Void);
    rpc AvailableInserts(AvailableInsertsRequest) returns (InsertOptions);
}

message Void {}

message InitRequest {
    string workspace = 1;
    string configUri = 2;
    SessionId sessionId = 3;
}

message SessionId {
    string id = 1;
}

message OpenRequest {
    string path = 1;
}

message EditRequest {
    string path = 1;
    LanguageObject editedObject = 2;
}

message EditResponse {
    LanguageObject newObject = 1;
    LanguageObject oldObject = 2;
}

message SaveRequest {
    string path = 1;
    string writePath = 2;
}

message CloseRequest {
    string path = 1;
}

message AvailableInsertsRequest {
    string path = 1;
    string nodeId = 2;
    string nodeKey = 3;
}

message InsertOptions {
    repeated LanguageObject options = 1;
}