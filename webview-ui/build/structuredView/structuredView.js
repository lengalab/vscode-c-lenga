import{b as l,j as e,v as i,L as I,M as f,O as S,N as E,c as M,d as D}from"../shared/vscode.js";const w=l.createContext(null);function A({debug:o,children:c}){return e.jsx(w.Provider,{value:{debug:o},children:c})}function K(){const[o,c]=l.useState(void 0),[r,x]=l.useState(null),[g,p]=l.useState(null),[t,j]=l.useState(null),[m,h]=l.useState(null),[u,v]=l.useState(!1);l.useEffect(()=>{const n=d=>{console.log("event:",d);const s=d.data;console.log("message:",s),s.type==="update"?c(s.contents):s.type==="availableInserts"?h(s.contents):s.type==="toggleDebug"&&(console.log("Toggling debug mode"),v(a=>!a))};return window.addEventListener("message",n),i.postMessage({type:"ready"}),()=>{window.removeEventListener("message",n)}},[]);const b=(n,d)=>{const s={type:"nodeEdit",contents:n,key:d};c(a=>a&&{...a}),console.log("sending message: ",s),i.postMessage(s)},y=(n,d)=>{const s={type:"requestAvailableInserts",nodeId:n,nodeKey:d};console.log("requesting available inserts: ",s),i.postMessage(s)};return e.jsx(e.Fragment,{children:e.jsxs(A,{debug:u,children:[o?e.jsxs(I,{sourceFile:o,onEdit:b,onRequestAvailableInserts:y,availableInserts:m,selectedNodeId:r,selectedKey:g,parentNodeInfo:t,setSelectedNodeId:x,setSelectedKey:p,setParentNodeInfo:j,children:[e.jsx(f,{}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:o==null?void 0:o.code.map((n,d)=>e.jsx(S,{node:n,children:e.jsx(E,{node:n,parentInfo:M(o,"code",d)})},n.id))})]}):e.jsx("p",{children:"loading..."}),u&&e.jsxs("div",{children:[e.jsx("h1",{children:"Debug Info"}),e.jsxs("p",{children:["selectedNodeId: ",r]}),e.jsxs("p",{children:["selectedKey: ",g]}),e.jsxs("p",{children:["parentNodeId: ",t==null?void 0:t.parent.id]}),e.jsxs("p",{children:["parentKey: ",t==null?void 0:t.key]}),e.jsxs("p",{children:["parentIndex: ",t==null?void 0:t.index]})]})]})})}D.createRoot(document.getElementById("root")).render(e.jsx(l.StrictMode,{children:e.jsx(K,{})}));
