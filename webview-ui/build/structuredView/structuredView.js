import{u as j,b as r,j as e,v as p,L as I,O as w,N as S,c as E,d as k}from"../shared/vscode.js";function D(){const{mode:s,setMode:a}=j(),[d,l]=r.useState(!1),c=()=>{a(s==="view"?"edit":"view")},x=g=>{(g.key==="Enter"||g.key===" ")&&(g.preventDefault(),c())},o="mode-indicator-keybind",v=s==="view"?"Press I to switch to edit mode":"Press Esc to return to view mode";return e.jsxs("div",{style:{position:"fixed",top:"10px",right:"10px",zIndex:1e3,display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"6px"},children:[e.jsxs("div",{onClick:c,onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),onFocus:()=>l(!0),onBlur:()=>l(!1),onKeyDown:x,role:"button",tabIndex:0,"aria-describedby":d?o:void 0,style:{padding:"5px 10px",backgroundColor:s==="view"?"var(--vscode-editorInfo-background)":"var(--vscode-editorWarning-background)",color:s==="view"?"var(--vscode-editorInfo-foreground)":"var(--vscode-editorWarning-foreground)",border:"1px solid "+(s==="view"?"var(--vscode-editorInfo-border)":"var(--vscode-editorWarning-border)"),borderRadius:"3px",fontSize:"12px",fontWeight:"bold",cursor:"pointer",transition:"box-shadow 0.15s ease, transform 0.15s ease, filter 0.15s ease",boxShadow:d?`0 0 0 2px ${s==="view"?"var(--vscode-editorInfo-border)":"var(--vscode-editorWarning-border)"}`:void 0,transform:d?"translateY(-1px)":void 0,filter:d?"brightness(1.05)":void 0},children:["MODE: ",s.toUpperCase()]}),d&&e.jsx("div",{id:o,style:{padding:"6px 8px",backgroundColor:"var(--vscode-editorWidget-background)",color:"var(--vscode-editorWidget-foreground)",border:"1px solid var(--vscode-editorWidget-border)",borderRadius:"3px",fontSize:"11px",whiteSpace:"nowrap",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.25)",pointerEvents:"none"},children:v})]})}const M=r.createContext(null);function W({debug:s,children:a}){return e.jsx(M.Provider,{value:{debug:s},children:a})}function C(){const[s,a]=r.useState(void 0),[d,l]=r.useState(null),[c,x]=r.useState(null),[o,v]=r.useState(null),[g,f]=r.useState(null),[b,h]=r.useState(!1);r.useEffect(()=>{const n=i=>{console.log("event:",i);const t=i.data;console.log("message:",t),t.type==="update"?a(t.contents):t.type==="availableInserts"?f(t.contents):t.type==="toggleDebug"&&(console.log("Toggling debug mode"),h(u=>!u))};return window.addEventListener("message",n),p.postMessage({type:"ready"}),()=>{window.removeEventListener("message",n)}},[]);const y=(n,i)=>{const t={type:"nodeEdit",contents:n,key:i};a(u=>u&&{...u}),console.log("sending message: ",t),p.postMessage(t)},m=(n,i)=>{const t={type:"requestAvailableInserts",nodeId:n,nodeKey:i};console.log("requesting available inserts: ",t),p.postMessage(t)};return e.jsx(e.Fragment,{children:e.jsxs(W,{debug:b,children:[s?e.jsxs(I,{sourceFile:s,onEdit:y,onRequestAvailableInserts:m,availableInserts:g,selectedNodeId:d,selectedKey:c,parentNodeInfo:o,setSelectedNodeId:l,setSelectedKey:x,setParentNodeInfo:v,children:[e.jsx(D,{}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:s==null?void 0:s.code.map((n,i)=>e.jsx(w,{node:n,children:e.jsx(S,{node:n,parentInfo:E(s,"code",i)})},n.id))})]}):e.jsx("p",{children:"loading..."}),b&&e.jsxs("div",{children:[e.jsx("h1",{children:"Debug Info"}),e.jsxs("p",{children:["selectedNodeId: ",d]}),e.jsxs("p",{children:["selectedKey: ",c]}),e.jsxs("p",{children:["parentNodeId: ",o==null?void 0:o.parent.id]}),e.jsxs("p",{children:["parentKey: ",o==null?void 0:o.key]}),e.jsxs("p",{children:["parentIndex: ",o==null?void 0:o.index]})]})]})})}k.createRoot(document.getElementById("root")).render(e.jsx(r.StrictMode,{children:e.jsx(C,{})}));
