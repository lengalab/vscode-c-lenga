import{u as b,b as n,j as e,v,L as I,S,d as E}from"../shared/vscode.js";function D(){const{mode:o,setMode:r}=b(),[d,s]=n.useState(!1),i=()=>{r(o==="view"?"edit":"view")},a=u=>{(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),i())},x="mode-indicator-keybind",p=o==="view"?"Press I to switch to edit mode":"Press Esc to return to view mode";return e.jsxs("div",{style:{position:"fixed",top:"10px",right:"10px",zIndex:1e3,display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"6px"},children:[e.jsxs("div",{onClick:i,onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),onFocus:()=>s(!0),onBlur:()=>s(!1),onKeyDown:a,role:"button","aria-describedby":d?x:void 0,style:{padding:"5px 10px",backgroundColor:o==="view"?"var(--vscode-editorInfo-background)":"var(--vscode-editorWarning-background)",color:o==="view"?"var(--vscode-editorInfo-foreground)":"var(--vscode-editorWarning-foreground)",border:"1px solid "+(o==="view"?"var(--vscode-editorInfo-border)":"var(--vscode-editorWarning-border)"),borderRadius:"3px",fontSize:"12px",fontWeight:"bold",cursor:"pointer",transition:"box-shadow 0.15s ease, transform 0.15s ease, filter 0.15s ease",boxShadow:d?`0 0 0 2px ${o==="view"?"var(--vscode-editorInfo-border)":"var(--vscode-editorWarning-border)"}`:void 0,transform:d?"translateY(-1px)":void 0,filter:d?"brightness(1.05)":void 0},children:["MODE: ",o.toUpperCase()]}),d&&e.jsx("div",{id:x,style:{padding:"6px 8px",backgroundColor:"var(--vscode-editorWidget-background)",color:"var(--vscode-editorWidget-foreground)",border:"1px solid var(--vscode-editorWidget-border)",borderRadius:"3px",fontSize:"11px",whiteSpace:"nowrap",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.25)",pointerEvents:"none"},children:p})]})}const f=n.createContext(null);function M(){const o=n.useContext(f);if(!o)throw new Error("DebugContext must be used inside a provider");return o}function k({debug:o,children:r}){return e.jsx(f.Provider,{value:{debug:o},children:r})}function C(){var a;const{debug:o}=M(),{selectedNodeId:r,selectedKey:d,parentNodeInfo:s,nodeMap:i}=b();return e.jsx(e.Fragment,{children:o&&e.jsxs("div",{children:[e.jsx("h1",{children:"Debug Info"}),e.jsxs("p",{children:["selectedNodeId: ",r]}),e.jsxs("p",{children:["selectedNodeType: ",(a=i.get(r??""))==null?void 0:a.type]}),e.jsxs("p",{children:["selectedKey: ",d]}),e.jsxs("p",{children:["parentNodeId: ",s==null?void 0:s.parent.id]}),e.jsxs("p",{children:["parentType: ",s==null?void 0:s.parent.type]}),e.jsxs("p",{children:["parentKey: ",s==null?void 0:s.key]}),e.jsxs("p",{children:["parentIndex: ",s==null?void 0:s.index]})]})})}function W(){const[o,r]=n.useState(void 0),[d,s]=n.useState(null),[i,a]=n.useState(null),[x,p]=n.useState(null),[u,h]=n.useState(null),[y,j]=n.useState(!1);n.useEffect(()=>{const c=l=>{console.log("event:",l);const t=l.data;console.log("message:",t),t.type==="update"?r(t.contents):t.type==="availableInserts"?h(t.contents):t.type==="toggleDebug"&&(console.log("Toggling debug mode"),j(g=>!g))};return window.addEventListener("message",c),v.postMessage({type:"ready"}),()=>{window.removeEventListener("message",c)}},[]);const m=(c,l)=>{const t={type:"nodeEdit",contents:c,key:l};r(g=>g&&{...g}),console.log("sending message: ",t),v.postMessage(t)},w=(c,l)=>{const t={type:"requestAvailableInserts",nodeId:c,nodeKey:l};console.log("requesting available inserts: ",t),v.postMessage(t)};return e.jsx(e.Fragment,{children:e.jsx(k,{debug:y,children:o?e.jsxs(I,{sourceFile:o,onEdit:m,onRequestAvailableInserts:w,availableInserts:u,selectedNodeId:d,selectedKey:i,parentNodeInfo:x,setSelectedNodeId:s,setSelectedKey:a,setParentNodeInfo:p,children:[e.jsx(D,{}),e.jsx(S,{node:o}),e.jsx(C,{})]}):e.jsx("p",{children:"loading..."})})})}E.createRoot(document.getElementById("root")).render(e.jsx(n.StrictMode,{children:e.jsx(W,{})}));
