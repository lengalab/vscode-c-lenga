import{j as t,R as p,b as o,c as x}from"./client.js";import{v as u}from"./vscode.js";const g=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),c=new Map;function d({indent:e,node:r,onEdit:n}){return t.jsxs("div",{style:{whiteSpace:"pre-wrap",fontFamily:"monospace"},children:["    ".repeat(e),i(r,e,n)]})}function i(e,r,n){switch(console.log(e.type),e.type){case"IncludeDecl":return j(e,n);case"FuncDecl":return f(e,r,n);case"VarDecl":return h(e,n);case"ParamDecl":return y(e);case"CompStmt":return l(e,r,n);case"ReturnStmt":return F(e,n);case"CallExpr":return E(e,n);case"DeclRefExpr":return v(e);case"AssignmentExpr":return R(g);case"LiteralExpr":return S(e);case"IdentifierExpr":return w(e);default:return"WIP"}}function j(e,r){return t.jsxs(t.Fragment,{children:["#include "," ",t.jsx("input",{className:"inline-editor",defaultValue:e.directive,onBlur:n=>{e.directive=n.target.value,console.log("blur"),r(e)}})]})}function f(e,r,n){return c.set(e.id,e),t.jsxs("div",{children:[t.jsxs("div",{children:[e.return_type," ",e.name," (",e.params.map(s=>`${s.data_type} ${s.name}`).join(", "),") ","{"]}),t.jsx(t.Fragment,{children:e.body?l(e.body,r+1,n):""}),t.jsx("div",{children:"}"})]})}function h(e,r){return c.set(e.id,e),t.jsxs(t.Fragment,{children:[e.data_type," ",e.name," ",e.initializer&&t.jsxs(t.Fragment,{children:["= ",i(e.initializer,0,r)]}),";"]})}function y(e){return c.set(e.id,e),t.jsxs(t.Fragment,{children:[e.data_type," ",e.name]})}function l(e,r,n){return e.statements.map((s,a)=>t.jsx(d,{node:s,indent:r,onEdit:n},a))}function F(e,r){return t.jsxs(t.Fragment,{children:["return ",e.expression?i(e.expression,0,r):"",";"]})}function E(e,r){return t.jsxs(t.Fragment,{children:[i(e.calle,0,r),"(",e.args.map((n,s)=>t.jsxs(p.Fragment,{children:[s>0&&", ",i(n,0,r)]},n.id)),");"]})}function v(e){const r=c.get(e.DeclRefId);return r?t.jsx(t.Fragment,{children:r.name}):t.jsx(t.Fragment,{children:e.DeclRefId})}function R(e){return t.jsxs(t.Fragment,{children:["TODO assignmentExpr. node id: "," ",e.id]})}function S(e){return t.jsx(t.Fragment,{children:e.value})}function w(e){return t.jsx(t.Fragment,{children:e.identifier})}function I(){const[e,r]=o.useState([]);o.useEffect(()=>{const s=a=>{const m=a.data;r(m.contents)};return window.addEventListener("message",s),u.postMessage({type:"ready"}),()=>{window.removeEventListener("message",s)}},[]);const n=s=>{const a={type:"nodeEdit",contents:s};console.log("sending message: ",a),u.postMessage(a)};return t.jsx("div",{children:e.map(s=>t.jsx(d,{node:s,indent:0,onEdit:n},s.id))})}x.createRoot(document.getElementById("root")).render(t.jsx(o.StrictMode,{children:t.jsx(I,{})}));
